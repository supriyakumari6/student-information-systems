<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>‚Ä¢ Profile & Settings ‚Äî Student Information System</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#F9FAFB;--panel:#FFFFFF;--text:#111827;--muted:#6B7280;--primary:#2563EB;--secondary:#10B981;--r:18px}
html.dark{--bg:#0F172A;--panel:#111827;--text:#F3F4F6;--muted:#9CA3AF;--primary:#3B82F6;--secondary:#34D399}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,sans-serif}
.header{display:flex;justify-content:space-between;align-items:center;padding:18px 22px;background:rgba(255,255,255,.6);backdrop-filter:blur(8px);box-shadow:0 6px 18px rgba(0,0,0,.06)}
html.dark .header{background:rgba(17,24,39,.6);box-shadow:0 6px 18px rgba(0,0,0,.35)}
.tbtn{padding:8px 12px;border-radius:10px;border:1px solid #E5E7EB;background:#fff;cursor:pointer}
html.dark .tbtn{background:#0b1220;border-color:#1f2937;color:#e5e7eb}
.container{max-width:900px;margin:20px auto;padding:16px}
.grid{display:grid;gap:16px;grid-template-columns:1fr}
@media(min-width:920px){.grid{grid-template-columns:1fr 1fr}}
.card{background:var(--panel);border-radius:18px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.06)}
html.dark .card{background:rgba(17,24,39,.6);box-shadow:0 10px 30px rgba(0,0,0,.35)}
input,select,textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #E5E7EB;background:#fff;margin:6px 0}
html.dark input,html.dark select,html.dark textarea{background:#0b1220;border-color:#1f2937;color:#e5e7eb}
.btn{padding:10px 12px;border-radius:12px;border:0;font-weight:700;cursor:pointer;background:linear-gradient(90deg,var(--primary),var(--secondary));color:#fff}
.avatar{width:64px;height:64px;border-radius:16px;object-fit:cover;box-shadow:0 4px 8px rgba(0,0,0,.2)}
.small{font-size:13px;color:var(--muted)}
</style>
</head>
<body>
<header class="header">
  <div style="font-weight:800;font-size:18px;color:var(--primary)">Student Information System ‚Ä¢ Profile</div>
  <div style="display:flex;gap:8px;align-items:center">
    <div id="userInfo" class="small">‚Äî</div>
    <button class="tbtn" id="themeBtn">üåó</button>
    <a href="dashboard.html" class="tbtn">‚Üê Back to Dashboard</a>
    <button class="tbtn" id="logoutBtn">Logout</button>
  </div>
</header>

<main class="container">
  <section class="grid">
    <div class="card">
      <h3 style="margin:0 0 8px">Your Profile</h3>
      <div style="display:flex;gap:12px;align-items:center;margin-bottom:12px">
        <img src="https://i.pravatar.cc/150?img=12" alt="avatar" class="avatar">
        <div>
          <div style="font-weight:700" id="p_name">‚Äî</div>
          <div id="p_role" class="small"></div>
        </div>
      </div>

      <label>Full Name</label><input id="f_name">
      <label>Email</label><input id="f_email" type="email">
      <label>Role</label><input id="f_role" disabled>
      <label>Phone</label><input id="f_phone" placeholder="+91 9xxxxxxxx">
      <label>Department</label><select id="f_dept"><option>CSE</option><option>ECE</option><option>ME</option><option>CE</option><option>EEE</option><option>IT</option></select>
      <label>Graduation Year</label><input id="f_year" type="number" min="2000" max="2099" value="2025">
      <button class="btn" id="saveBtn" style="margin-top:10px">Save Changes</button>
    </div>

    <div class="card">
      <h3 style="margin:0 0 8px">Preferences</h3>
      <label><input type="checkbox" id="autoSave" checked> Auto-Save Student Data</label><br>
      <label><input type="checkbox" id="csvExport" checked> Enable CSV Export</label><br>
      <label><input type="checkbox" id="confirmDelete" checked> Confirm Before Delete</label><br><br>

      <h4>Theme</h4>
      <button class="btn" id="toggleTheme">Toggle Dark/Light</button>
      <p class="small" style="margin-top:8px">System preference is respected on first load.</p>
    </div>
  </section>
</main>

<script>
// Auth guard
if(localStorage.getItem('isLoggedIn')!=='true'){
  location.href='login.html';
}
const currentUser = JSON.parse(localStorage.getItem('currentUser')||'{}');
document.getElementById('userInfo').textContent = `${currentUser.name||'User'} ‚Ä¢ ${currentUser.role||''}`;
document.getElementById('p_name').textContent = currentUser.name||'User';
document.getElementById('p_role').textContent = currentUser.role||'';

// Prefill
document.getElementById('f_name').value = currentUser.name||'';
document.getElementById('f_email').value = currentUser.email||'';
document.getElementById('f_role').value = currentUser.role||'Student';

document.getElementById('saveBtn').addEventListener('click',()=>{
  currentUser.name = document.getElementById('f_name').value.trim();
  currentUser.email = document.getElementById('f_email').value.trim();
  currentUser.phone = document.getElementById('f_phone').value.trim();
  currentUser.dept = document.getElementById('f_dept').value;
  currentUser.year = document.getElementById('f_year').value;
  localStorage.setItem('currentUser',JSON.stringify(currentUser));
  alert('Profile updated successfully!');
});

// Preferences (save to localStorage)
const prefs = {autoSave:'autoSave',csvExport:'csvExport',confirmDelete:'confirmDelete'};
for(const key in prefs){
  const el=document.getElementById(key);
  const saved=localStorage.getItem(prefs[key]);
  if(saved!==null) el.checked=saved==='true';
  el.addEventListener('change',()=>localStorage.setItem(prefs[key],el.checked));
}

// Logout
document.getElementById('logoutBtn').addEventListener('click',()=>{
  localStorage.removeItem('isLoggedIn');
  localStorage.removeItem('currentUser');
  location.href='login.html';
});

// Theme handling
function applyTheme(){
  if(localStorage.getItem('theme')==='dark'){document.documentElement.classList.add('dark');}
  else{document.documentElement.classList.remove('dark');}
}
applyTheme();
document.getElementById('themeBtn').addEventListener('click',()=>{
  document.documentElement.classList.toggle('dark');
  localStorage.setItem('theme',document.documentElement.classList.contains('dark')?'dark':'light');
});
document.getElementById('toggleTheme').addEventListener('click',()=>{
  document.getElementById('themeBtn').click();
});
</script>
</body>
</html>
